{{- printf "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>" | safeHTML -}}
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:xhtml="http://www.w3.org/1999/xhtml">
  {{- range .Data.Pages }}
  <url>
    <loc>{{ .Permalink }}</loc>
    {{- $lastmod := .Lastmod -}}
    {{- if .IsHome -}}
      {{- with first 1 (.Site.RegularPages.ByLastmod.Reverse) -}}
        {{- $lastmod = (index . 0).Lastmod -}}
      {{- end -}}
    {{- else if .IsSection -}}
      {{- with first 1 (.RegularPagesRecursive.ByLastmod.Reverse) -}}
        {{- $lastmod = (index . 0).Lastmod -}}
      {{- end -}}
    {{- end -}}
    {{- if not $lastmod.IsZero }}
    <lastmod>{{ $lastmod.Format "2006-01-02T15:04:05-07:00" | safeHTML }}</lastmod>
    {{- end }}
    {{- if ge .Sitemap.Priority 0.0 }}
    <priority>{{ printf "%.1f" .Sitemap.Priority }}</priority>
    {{- end }}
    {{- if .Sitemap.Changefreq }}
    <changefreq>{{ .Sitemap.Changefreq }}</changefreq>
    {{- end }}
    {{- range sort (.AllTranslations) "Lang" }}
    <xhtml:link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}" />
    {{- end }}
  </url>
  {{- end }}
</urlset>
